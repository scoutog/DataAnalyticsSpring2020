z <- "Violent Crime in 2000"
jpeg(x, width = 568, height = 376)
plot_usmap(data = subset(total_df, Year == y), values = "Violent.crime.total",  color = orange, labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Violent Crime", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = z, caption = "Source: FBI UCR")
dev.off()
x <- "2001violent.jpg"
y <- 2001
z <- "Violent Crime in 2001"
jpeg(x, width = 568, height = 376)
plot_usmap(data = subset(total_df, Year == y), values = "Violent.crime.total",  color = orange, labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Violent Crime", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = z, caption = "Source: FBI UCR")
dev.off()
x <- "2002violent.jpg"
y <- 2002
z <- "Violent Crime in 2002"
jpeg(x, width = 568, height = 376)
plot_usmap(data = subset(total_df, Year == y), values = "Violent.crime.total",  color = orange, labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Violent Crime", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = z, caption = "Source: FBI UCR")
dev.off()
x <- "2003violent.jpg"
y <- 2003
z <- "Violent Crime in 2003"
jpeg(x, width = 568, height = 376)
plot_usmap(data = subset(total_df, Year == y), values = "Violent.crime.total",  color = orange, labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Violent Crime", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = z, caption = "Source: FBI UCR")
dev.off()
x <- "2004violent.jpg"
y <- 2004
z <- "Violent Crime in 2004"
jpeg(x, width = 568, height = 376)
plot_usmap(data = subset(total_df, Year == y), values = "Violent.crime.total",  color = orange, labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Violent Crime", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = z, caption = "Source: FBI UCR")
dev.off()
x <- "2005violent.jpg"
y <- 2005
z <- "Violent Crime in 2005"
jpeg(x, width = 568, height = 376)
plot_usmap(data = subset(total_df, Year == y), values = "Violent.crime.total",  color = orange, labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Violent Crime", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = z, caption = "Source: FBI UCR")
dev.off()
x <- "2006violent.jpg"
y <- 2006
z <- "Violent Crime in 2006"
jpeg(x, width = 568, height = 376)
plot_usmap(data = subset(total_df, Year == y), values = "Violent.crime.total",  color = orange, labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Violent Crime", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = z, caption = "Source: FBI UCR")
dev.off()
x <- "2007violent.jpg"
y <- 2007
z <- "Violent Crime in 2007"
jpeg(x, width = 568, height = 376)
plot_usmap(data = subset(total_df, Year == y), values = "Violent.crime.total",  color = orange, labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Violent Crime", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = z, caption = "Source: FBI UCR")
dev.off()
x <- "2008violent.jpg"
y <- 2008
z <- "Violent Crime in 2008"
jpeg(x, width = 568, height = 376)
plot_usmap(data = subset(total_df, Year == y), values = "Violent.crime.total",  color = orange, labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Violent Crime", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = z, caption = "Source: FBI UCR")
dev.off()
x <- "2009violent.jpg"
y <- 2009
z <- "Violent Crime in 2009"
jpeg(x, width = 568, height = 376)
plot_usmap(data = subset(total_df, Year == y), values = "Violent.crime.total",  color = orange, labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Violent Crime", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = z, caption = "Source: FBI UCR")
dev.off()
x <- "2010violent.jpg"
y <- 2010
z <- "Violent Crime in 2010"
jpeg(x, width = 568, height = 376)
plot_usmap(data = subset(total_df, Year == y), values = "Violent.crime.total",  color = orange, labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Violent Crime", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = z, caption = "Source: FBI UCR")
dev.off()
x <- "2011violent.jpg"
y <- 2011
z <- "Violent Crime in 2011"
jpeg(x, width = 568, height = 376)
plot_usmap(data = subset(total_df, Year == y), values = "Violent.crime.total",  color = orange, labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Violent Crime", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = z, caption = "Source: FBI UCR")
dev.off()
x <- "2012violent.jpg"
y <- 2012
z <- "Violent Crime in 2012"
jpeg(x, width = 568, height = 376)
plot_usmap(data = subset(total_df, Year == y), values = "Violent.crime.total",  color = orange, labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Violent Crime", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = z, caption = "Source: FBI UCR")
dev.off()
x <- "2013violent.jpg"
y <- 2013
z <- "Violent Crime in 2013"
jpeg(x, width = 568, height = 376)
plot_usmap(data = subset(total_df, Year == y), values = "Violent.crime.total",  color = orange, labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Violent Crime", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = z, caption = "Source: FBI UCR")
dev.off()
x <- "2014violent.jpg"
y <- 2014
z <- "Violent Crime in 2014"
jpeg(x, width = 568, height = 376)
plot_usmap(data = subset(total_df, Year == y), values = "Violent.crime.total",  color = orange, labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Violent Crime", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = z, caption = "Source: FBI UCR")
dev.off()
x <- "2015violent.jpg"
y <- 2015
z <- "Violent Crime in 2015"
jpeg(x, width = 568, height = 376)
plot_usmap(data = subset(total_df, Year == y), values = "Violent.crime.total",  color = orange, labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Violent Crime", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = z, caption = "Source: FBI UCR")
dev.off()
x <- "2016violent.jpg"
y <- 2016
z <- "Violent Crime in 2016"
jpeg(x, width = 568, height = 376)
plot_usmap(data = subset(total_df, Year == y), values = "Violent.crime.total",  color = orange, labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Violent Crime", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = z, caption = "Source: FBI UCR")
dev.off()
plot_usmap(data = subset(total_df, Year == y), values = "Violent.crime.total",  color = orange, labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Violent Crime", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = z, caption = "Source: FBI UCR")
library(tidyverse)
df <- read.csv("crimes_state_time.csv")
df<-df[,-c(7,17)]
rate<-c(1,2,3,13:21)
total<-c(1:12)
rates_df <- df[,rate]
total_df <- df[,total]
all <- c(3:12)
library(BBmisc)
# rates_df[,all] <- sapply(rates_df[all], normalize)
# total_df[,all] <- sapply(total_df[all], normalize)
fips <- read.csv("us-state-ansi-fips.csv")
names(fips)[names(fips) == "stname"] <- "State"
rates_df <- left_join(rates_df, fips, by = "State")
total_df <- left_join(total_df, fips, by = "State")
rates2010 <- subset(rates_df, Year == 2010)
names(rates2010)[names(rates2010) == "State"] <- "state"
names(rates_df)[names(rates_df) == "State"] <- "state"
names(total_df)[names(total_df) == "State"] <- "state"
##########
library(gtrendsR)
library(usmap)
orange <- "#0C95BC"
plot_usmap(data = rates2010, values = "Population",  color = orange, labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Popularity", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = "Population in 2010", caption = "Source: FBI UCR")
plot_usmap(data = rates2010, values = "Population", include =  c(.south_atlantic, .mid_atlantic, .new_england ), color = orange, labels=TRUE) +
scale_fill_continuous( low = "white", high = orange,
name = "Popularity", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = "US East Coast Population", caption = "Source: FBI UCR")
########################################
########################################
########################################
summary(rates_df$Year)
View(total_df)
x <- "2016violent.jpg"
y <- 2016
z <- "Violent Crime in 2016"
#jpeg(x, width = 568, height = 376)
plot_usmap(data = subset(total_df, Year == y), values = "Violent.crime.total",  color = orange, labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Violent Crime", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = z, caption = "Source: FBI UCR")
#dev.off()
plot_usmap(data = subset(total_df, Year == y), values = "Violent.crime.total",  color = orange, labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Violent Crime", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = z, caption = "Source: FBI UCR")
plot_usmap(data = subset(total_df, Year == y), values = "Violent.crime.total",  color = orange, labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Violent Crime", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = z, caption = "Source: FBI UCR")
editor_options:
chunk_output_type: console
editor_options:
chunk_output_type: console
chunk_output_type: console
install.packages(c("choroplethr", "choroplethrMaps", "plotly", "tm", "wordcloud"))
library(tidyverse)
library(tidyverse)
df <- read.csv("crimes_state_time.csv")
df<-df[,-c(7,17)]
rate<-c(1,2,3,13:21)
total<-c(1:12)
rates_df <- df[,rate]
total_df <- df[,total]
all <- c(3:12)
library(BBmisc)
fips <- read.csv("us-state-ansi-fips.csv")
names(fips)[names(fips) == "stname"] <- "State"
rates_df <- left_join(rates_df, fips, by = "State")
total_df <- left_join(total_df, fips, by = "State")
rates2010 <- subset(rates_df, Year == 2010)
names(rates2010)[names(rates2010) == "State"] <- "state"
names(rates_df)[names(rates_df) == "State"] <- "state"
names(total_df)[names(total_df) == "State"] <- "state"
##########
library(gtrendsR)
library(usmap)
orange <- "#0C95BC"
plot_usmap(data = rates2010, values = "Population",  color = orange, labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Popularity", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = "Population in 2010", caption = "Source: FBI UCR")
plot_usmap(data = rates2010, values = "Population", include =  c(.south_atlantic, .mid_atlantic, .new_england ), color = orange, labels=TRUE) +
scale_fill_continuous( low = "white", high = orange,
name = "Popularity", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = "US East Coast Population", caption = "Source: FBI UCR")
########################################
########################################
########################################
summary(rates_df$Year)
View(total_df)
########################################
########################################
########################################
summary(rates_df$Year)
x <- "2016violent.jpg"
y <- 2016
z <- "Violent Crime in 2016"
#jpeg(x, width = 568, height = 376)
plot_usmap(data = subset(total_df, Year == y), values = "Violent.crime.total",  color = orange, labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Violent Crime", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = z, caption = "Source: FBI UCR")
x <- "2014violent.jpg"
y <- 2014
z <- "Violent Crime in 2014"
#jpeg(x, width = 568, height = 376)
plot_usmap(data = subset(total_df, Year == y), values = "Violent.crime.total",  color = orange, labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Violent Crime", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = z, caption = "Source: FBI UCR")
#dev.off()
by_state <- total_df %>% group_by(state) %>% select(state) %>% summarise(Count = n()) %>% arrange(desc(Count))
head(by_state, 10)
tail(by_state, 10)
ggplot(head(by_state, 10), aes(reorder(state, -Violent.crime.total), Count, fill = Violent.crime.total)) +
geom_bar(stat = "identity") + xlab("State") + ylab("Number of Complaints") +
theme(axis.text.x = element_text(angle = 50, size = 10, vjust = 0.4, face = "bold"),
plot.title = element_text(size = 20, face = "bold", vjust = 2),
axis.title.x = element_text(face = "bold", size = 15, vjust = -0.35),
axis.title.y = element_text(face = "bold", vjust = 0.35, size = 15)) +
theme(legend.position = "none" )
by_state <- total_df %>% group_by(state) %>% select(state, Year, Violent.crime.total)
head(by_state, 10)
tail(by_state, 10)
ggplot(head(by_state, 10), aes(reorder(state, -Violent.crime.total), Count, fill = Violent.crime.total)) +
geom_bar(stat = "identity") + xlab("State") + ylab("Number of Complaints") +
theme(axis.text.x = element_text(angle = 50, size = 10, vjust = 0.4, face = "bold"),
plot.title = element_text(size = 20, face = "bold", vjust = 2),
axis.title.x = element_text(face = "bold", size = 15, vjust = -0.35),
axis.title.y = element_text(face = "bold", vjust = 0.35, size = 15)) +
theme(legend.position = "none" )
ggplot(head(by_state, 10), aes(reorder(state, -Violent.crime.total), Violent.crime.total, fill = Violent.crime.total)) +
geom_bar(stat = "identity") + xlab("State") + ylab("Number of Complaints") +
theme(axis.text.x = element_text(angle = 50, size = 10, vjust = 0.4, face = "bold"),
plot.title = element_text(size = 20, face = "bold", vjust = 2),
axis.title.x = element_text(face = "bold", size = 15, vjust = -0.35),
axis.title.y = element_text(face = "bold", vjust = 0.35, size = 15)) +
theme(legend.position = "none" )
by_state <- total_df %>% select(Year == 2000)  %>% group_by(state) %>% select(state, Year, Violent.crime.total)
by_state <- total_df %>% select(year == 2000)  %>% group_by(state) %>% select(state, Year, Violent.crime.total)
total_df
by_state <- total_df %>% select(Year == 2000)  %>% group_by(state) %>% select(state, Year, Violent.crime.total)
by_state1 <- total_df %>% select(Year == 2000)  %>% group_by(state) %>% select(state, Year, Violent.crime.total)
by_state <- total_df %>% select(Year == 2000)  %>% group_by(state) %>% select(state, Year, Violent.crime.total)
by_state <- total_df %>% filter(Year == 2000)  %>% group_by(state) %>% select(state, Year, Violent.crime.total)
head(by_state, 10)
tail(by_state, 10)
ggplot(head(by_state, 10), aes(reorder(state, -Violent.crime.total), Violent.crime.total, fill = Violent.crime.total)) +
geom_bar(stat = "identity") + xlab("State") + ylab("Number of Complaints") +
theme(axis.text.x = element_text(angle = 50, size = 10, vjust = 0.4, face = "bold"),
plot.title = element_text(size = 20, face = "bold", vjust = 2),
axis.title.x = element_text(face = "bold", size = 15, vjust = -0.35),
axis.title.y = element_text(face = "bold", vjust = 0.35, size = 15)) +
theme(legend.position = "none" )
library(plyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(plotly)
library(RColorBrewer)
library(choroplethrMaps)
library(choroplethr)
library(tm)
library(wordcloud)
library(RColorBrewer)
by_state <- total_df %>% filter(Year == 2000)  %>% group_by(state) %>% select(state, Year, Violent.crime.total)
head(by_state, 10)
tail(by_state, 10)
ggplot(head(by_state, 10), aes(reorder(state, -Violent.crime.total), Violent.crime.total, fill = Violent.crime.total)) +
geom_bar(stat = "identity") + xlab("State") + ylab("Number of Complaints") +
theme(axis.text.x = element_text(angle = 50, size = 10, vjust = 0.4, face = "bold"),
plot.title = element_text(size = 20, face = "bold", vjust = 2),
axis.title.x = element_text(face = "bold", size = 15, vjust = -0.35),
axis.title.y = element_text(face = "bold", vjust = 0.35, size = 15)) +
theme(legend.position = "none" )
data("state.regions")
tomap <- total_df %>% group_by(State) %>% summarise(Total = n())
names(total_df)[names(total_df) == "state"] <- "State"
tomap <- total_df %>% group_by(State) %>% summarise(Total = n())
tomap <- subset(tomap, State %in% state.abb)
tomap <- as.data.frame(tomap)
names(tomap) <- c("region", "value")
tomap$region <- state.regions[match(tomap$region, state.regions$abb), 1]
## Map1
state_choropleth(tomap, title = "Complaints by State", legend = "Number of Complaints")
## Map2
state_choropleth(num_colors = 9, tomap, title = "Complaints by State", legend = "Number of Complaints")
tomap <- total_df %>% filter(Year == 2000) %>%  group_by(State) %>% summarise(Total = n())
tomap <- subset(tomap, State %in% state.abb)
tomap <- as.data.frame(tomap)
names(tomap) <- c("region", "value")
tomap$region <- state.regions[match(tomap$region, state.regions$abb), 1]
## Map2
state_choropleth(num_colors = 9, tomap, title = "Complaints by State", legend = "Number of Complaints")
View(total_df)
# Map3 by company
mapdata <- complaints[complaints$State !="",] %>% group_by(State, Violent.crime.total) %>% summarise(Total = n()) %>% arrange(desc(Total))
# Map3 by company
mapdata <- complaints[total_df$State !="",] %>% group_by(State, Violent.crime.total) %>% summarise(Total = n()) %>% arrange(desc(Total))
# Map3 by company
mapdata <- total_df[total_df$State !="",] %>% group_by(State, Violent.crime.total) %>% summarise(Total = n()) %>% arrange(desc(Total))
mapdata$Violent.crime.total <- factor(mapdata$Violent.crime.total)
tomap_3 <- by(mapdata, mapdata["State"], head, n=1)
tomap_3 <- Reduce(rbind, tomap_3)
tomap_3$Violent.crime.total <- factor(tomap_3$Violent.crime.total)
tomap_3 <- tomap_3[,-3]
tomap_3 <- subset(tomap_3, State %in% state.abb)
names(tomap_3) <- c("region", "value")
tomap_3$region <- state.regions[match(tomap_3$region, state.regions$abb), 1]
tomap_3$value <- factor(tomap_3$value)
table(tomap_3$value)
choro = StateChoropleth$new(tomap_3)
choro$title = "Financial Consumer Complaints - Companies with Most Complaints Statewise"
choro$ggplot_scale = scale_fill_manual(name="Company", values=c("red", "orange", "lightblue", "yellow", "blue"), drop=FALSE)
choro$ggplot_scale = scale_fill_manual(name="Company", values=c("#a6cee3", "#e31a1c", "#1f78b4", "#b2df8a", "#33a02c", "#fb9a99", "#fdbf6f", "#ff7f00", "#cab2d6", "#6a3d9a"), drop=FALSE)
choro$render()
# Map4 by product
mapdata <- total_df[total_df$State !="",] %>% group_by(State, Violent.crime.total) %>% summarise(Total = n()) %>% arrange(desc(Total))
mapdata$Violent.crime.total <- numeric(mapdata$Violent.crime.total)
library(RColorBrewer)
library(rgdal)
US3 <- readOGR(dsn="Projectmaps", layer = "US3")
mycolours <- brewer.pal(8, "Blues")
mybreaks <- c(0, 20, 40, 50, 60, 80, 100)
xyz <- total_df %>% filter(Year = 2000)
xyz <- total_df %>% filter(Year == 2000)
cut(xyz$Violent.crime.total, mybreaks)
View(xyz)
library(RColorBrewer)
library(rgdal)
US3 <- readOGR(dsn="Projectmaps", layer = "US3")
mycolours <- brewer.pal(8, "Blues")
mybreaks <- c(0, 20, 40, 50, 60, 80, 100)
cut(xyz$Violent.crime.total, mybreaks)
mycolourscheme <- mycolours[findInterval(xyz$Violent.crime.total, vec = mybreaks)]
plot(xyz, col = mycolourscheme, main = "Percentage Vote Share for Bush - 2004", cex = 5)
max(xyz$Violent.crime.total)
library(RColorBrewer)
library(rgdal)
mycolours <- brewer.pal(8, "Blues")
mybreaks <- c(0, 36000, 72000, 108000, 144000, 180000, 216000)
cut(xyz$Violent.crime.total, mybreaks)
mycolourscheme <- mycolours[findInterval(xyz$Violent.crime.total, vec = mybreaks)]
plot(xyz, col = mycolourscheme, main = "Percentage Vote Share for Bush - 2004", cex = 5)
legend(-119, 31.5, legend = levels(cut(US3$Bush_pct, mybreaks)), fill = mycolourscheme, cex = 0.8, title = "% vote for Bush")
legend(-119, 31.5, legend = levels(cut(xyz$Violent.crime.total, mybreaks)), fill = mycolourscheme, cex = 0.8, title = "% vote for Bush")
plot(xyz, col = mycolourscheme, main = "Percentage Vote Share for Bush - 2004", cex = 5)
legend(-119, 31.5, legend = levels(cut(xyz$Violent.crime.total, mybreaks)), fill = mycolourscheme, cex = 0.8, title = "% vote for Bush")
by_state <- total_df  %>% group_by(state) %>% select(state, Year, Violent.crime.total)
names(rates2010)[names(rates2010) == "State"] <- "state"
names(rates_df)[names(rates_df) == "State"] <- "state"
names(total_df)[names(total_df) == "State"] <- "state"
by_state <- total_df  %>% group_by(state) %>% select(state, Year, Violent.crime.total)
head(by_state, 10)
tail(by_state, 10)
ggplot(head(by_state, 10), aes(reorder(state, -Violent.crime.total), Violent.crime.total, fill = Violent.crime.total)) +
geom_bar(stat = "identity") + xlab("State") + ylab("Number of Complaints") +
theme(axis.text.x = element_text(angle = 50, size = 10, vjust = 0.4, face = "bold"),
plot.title = element_text(size = 20, face = "bold", vjust = 2),
axis.title.x = element_text(face = "bold", size = 15, vjust = -0.35),
axis.title.y = element_text(face = "bold", vjust = 0.35, size = 15)) +
theme(legend.position = "none" )
by_state <- total_df  %>% filter(Year == 2000) %>% group_by(state) %>% select(state, Year, Violent.crime.total)
head(by_state, 10)
tail(by_state, 10)
ggplot(head(by_state, 10), aes(reorder(state, -Violent.crime.total), Violent.crime.total, fill = Violent.crime.total)) +
geom_bar(stat = "identity") + xlab("State") + ylab("Number of Complaints") +
theme(axis.text.x = element_text(angle = 50, size = 10, vjust = 0.4, face = "bold"),
plot.title = element_text(size = 20, face = "bold", vjust = 2),
axis.title.x = element_text(face = "bold", size = 15, vjust = -0.35),
axis.title.y = element_text(face = "bold", vjust = 0.35, size = 15)) +
theme(legend.position = "none" )
